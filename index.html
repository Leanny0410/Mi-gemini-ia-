<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <!-- Icono personalizado (puedes cambiarlo si tienes uno) -->
    <link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='50%' dominant-baseline='middle' text-anchor='middle' x='50%' font-size='90'%3Eü§ñ%3C/text%3E%3C/svg%3E" type="image/svg+xml">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leanny IA - ChatBot</title> <!-- T√≠tulo Actualizado -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="theme-switcher">
        <button id="theme-btn" title="Cambiar Tema">üåô</button>
    </div>

    <main class="app-container">
        <header class="app-header">
             <!-- Icono SVG simple de un bot -->
             <svg class="header-icon" xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 8V4H8"/><rect x="4" y="12" width="16" height="8" rx="2"/><path d="M4 14h16"/><path d="M15 7h1a2 2 0 0 1 2 2v2.5"/><path d="M8 7H7a2 2 0 0 0-2 2v2.5"/><path d="M7 12v-2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5V12"/><path d="M15 12v-2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5V12"/><path d="M7 16v.01"/><path d="M17 16v.01"/></svg>
            <h1>Leanny IA</h1> <!-- Nombre Actualizado -->
            <p>Hola, soy Leanny IA. Preg√∫ntame algo de mi lista.</p> <!-- Subt√≠tulo Actualizado -->
        </header>

        <section class="input-section">
            <textarea id="prompt-input" class="prompt-textarea" placeholder="Escribe aqu√≠... ej: ¬øQui√©n eres?, ¬øQu√© es una API?, ¬øCapital de Francia?"></textarea> <!-- Placeholder actualizado -->
            <div class="action-buttons">
                <button id="submit-button" title="Enviar Pregunta">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"/></svg>
                    <span>Enviar</span>
                </button>
                <button id="clear-button" title="Limpiar Todo">
                     <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16"><path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm-9.954 1H14.454l-.848 10.58a1 1 0 0 1-.997.92H4.885a1 1 0 0 1-.997-.92zm2.94 1.84V14H6v-7.66zm3 0V14h1v-7.66zm3 0V14h1v-7.66z"/></svg>
                    <span>Limpiar</span>
                </button>
            </div>
        </section>

        <section class="output-section">
            <div class="output-header">
                <h2>Respuesta de Leanny IA:</h2> <!-- Nombre Actualizado -->
                <div class="output-actions">
                    <button id="copy-button" title="Copiar Respuesta" disabled>
                         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/></svg>
                        <span>Copiar</span>
                    </button>
                    <button id="save-button" title="Guardar como TXT" disabled>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-arrow-down" viewBox="0 0 16 16"><path d="M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293z"/><path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"/></svg>
                        <span>Guardar</span>
                    </button>
                </div>
            </div>
            <div id="response-box" class="response-box">
                <p>¬°Hola! Soy Leanny IA. ¬øListo para preguntar?</p> <!-- Mensaje inicial Actualizado -->
            </div>
        </section>

        <div id="loader" class="loader-overlay" style="display: none;">
            <div class="spinner"></div>
            <p>Procesando...</p> <!-- Texto ajustado -->
        </div>
    </main>

    <!-- Librer√≠as JS -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Script principal de la aplicaci√≥n -->
    <script>
        // --- Referencias a Elementos del DOM ---
        const promptInput = document.getElementById('prompt-input');
        const submitButton = document.getElementById('submit-button');
        const clearButton = document.getElementById('clear-button');
        const responseBox = document.getElementById('response-box');
        const copyButton = document.getElementById('copy-button');
        const saveButton = document.getElementById('save-button');
        const themeButton = document.getElementById('theme-btn');
        const loader = document.getElementById('loader');
        const htmlElement = document.documentElement;

        // --- Estado Inicial ---
        copyButton.disabled = true;
        saveButton.disabled = true;

        // --- L√≥gica del Tema ---
        function applyTheme(theme) {
            htmlElement.setAttribute('data-theme', theme);
            themeButton.textContent = theme === 'light' ? 'üåô' : '‚òÄÔ∏è';
            localStorage.setItem('appTheme', theme);
            const prismLink = document.querySelector('link[href*="prism"]');
            if (prismLink) {
                prismLink.href = theme === 'dark'
                    ? 'https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css'
                    : 'https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css';
            }
        }
        themeButton.addEventListener('click', () => {
            const newTheme = htmlElement.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            applyTheme(newTheme);
        });
        const savedTheme = localStorage.getItem('appTheme') || 'light';
        applyTheme(savedTheme);

        // ===========================================================
        // --- BASE DE DATOS DE PREGUNTAS Y RESPUESTAS DE LEANNY IA ---
        // ===========================================================
        const predefinedQA = [
            // --- Preguntas espec√≠ficas solicitadas ---
            {
                question: "quien eres",
                question_alt: "quien eres y que puedes hacer por mi",
                answer: "Soy Leanny IA, un asistente virtual basado en texto con respuestas predefinidas. Estoy aqu√≠ para responder a preguntas de mi lista sobre diversos temas como cultura general, tecnolog√≠a b√°sica, y m√°s. ¬°Preg√∫ntame!"
            },
            {
                question: "que es una api",
                question_alt: "que es una api y una api rest",
                answer: "Una **API** (Interfaz de Programaci√≥n de Aplicaciones) es como un conjunto de reglas y herramientas que permiten que diferentes programas o servicios 'hablen' entre s√≠ e intercambien informaci√≥n de forma estructurada. \nUna **API REST** es un tipo muy com√∫n de API web que sigue los principios de dise√±o REST (Transferencia de Estado Representacional). Usa m√©todos HTTP est√°ndar (como GET para obtener datos, POST para crear, etc.) y generalmente trabaja con formatos como JSON. Simplifica mucho la comunicaci√≥n entre sistemas en la web."
            },
            {
                question: "cual es la diferencia entre api y api rest", // Pregunta m√°s espec√≠fica
                answer: "La principal diferencia es que 'API' es el t√©rmino general para cualquier interfaz que permita la comunicaci√≥n entre software. En cambio, 'REST' es un conjunto espec√≠fico de reglas o estilo arquitect√≥nico para dise√±ar APIs web, enfocado en la simplicidad, escalabilidad y el uso de est√°ndares HTTP."
            },

            // --- Las 20 preguntas proporcionadas por el usuario ---
            {
                question: "que tiempo hace hoy",
                question_alt: "como esta el clima",
                answer: "¬°Buena pregunta! Para darte el pron√≥stico del tiempo, necesitar√≠a saber tu ubicaci√≥n actual. Como soy un bot simple, no tengo acceso a esa informaci√≥n."
            },
            {
                question: "cual es la capital de francia",
                answer: "La capital de Francia es **Par√≠s**."
            },
            {
                question: "como se prepara una tortilla espa√±ola",
                answer: "Para una tortilla espa√±ola cl√°sica necesitas patatas, cebolla (opcional para algunos), huevos, sal y aceite de oliva. \n1. Pela y corta las patatas en rodajas finas (y la cebolla si usas). \n2. Fr√≠elas lentamente en abundante aceite hasta que est√©n tiernas. Esc√∫rrelas bien. \n3. Bate los huevos en un bol grande con sal. \n4. A√±ade las patatas (y cebolla) fritas a los huevos batidos y mezcla. \n5. Calienta un poco de aceite en una sart√©n antiadherente, vierte la mezcla y cocina a fuego medio-bajo. \n6. Cuando est√© cuajada por abajo, dale la vuelta con ayuda de un plato y cocina por el otro lado hasta que est√© a tu gusto. ¬°Listo!"
            },
            {
                question: "que es la inteligencia artificial",
                question_alt: "que es ia",
                answer: "La **Inteligencia Artificial (IA)** es un √°rea de la inform√°tica dedicada a crear sistemas o m√°quinas capaces de realizar tareas que normalmente requieren inteligencia humana, como aprender, razonar, resolver problemas, percibir, comprender el lenguaje y tomar decisiones."
            },
            {
                question: "cual es la formula de la relatividad de einstein",
                question_alt: "formula einstein",
                // Usamos Markdown para formato simple, el navegador no interpretar√° LaTeX directamente
                answer: "La f√≥rmula m√°s famosa de Einstein, parte de su teor√≠a de la relatividad especial, es **E = mc¬≤**. Esta ecuaci√≥n expresa la equivalencia entre la energ√≠a (E) y la masa (m), donde 'c' es la velocidad de la luz en el vac√≠o. Significa que una peque√±a cantidad de masa puede convertirse en una gran cantidad de energ√≠a (y viceversa)."
            },
            {
                question: "como puedo mejorar mi productividad",
                answer: "¬°Mejorar la productividad es un gran objetivo! Aqu√≠ tienes algunas ideas: \n*   **Define metas claras:** Saber qu√© quieres lograr. \n*   **Prioriza:** Enf√≥cate en lo m√°s importante primero. \n*   **T√©cnica Pomodoro:** Trabaja en bloques de tiempo (ej. 25 min) con descansos cortos. \n*   **Minimiza distracciones:** Silencia notificaciones innecesarias. \n*   **Organiza tu espacio:** Un lugar ordenado ayuda a la concentraci√≥n. \n*   **Descansa bien:** Dormir lo suficiente es crucial."
            },
            {
                question: "que libros me recomiendas para aprender sobre liderazgo",
                answer: "Hay muchos libros excelentes sobre liderazgo. Dos cl√°sicos muy recomendados son: \n1.  **'Los 7 h√°bitos de la gente altamente efectiva'** de Stephen Covey. \n2.  **'C√≥mo ganar amigos e influir sobre las personas'** de Dale Carnegie (aunque no es solo de liderazgo, es fundamental para las relaciones interpersonales). \nOtros populares incluyen 'Inteligencia Emocional' de Daniel Goleman y 'Empieza con el porqu√©' de Simon Sinek."
            },
            {
                question: "como se dice hola como estas en frances",
                answer: "En franc√©s se dice: **'Bonjour, comment √ßa va ?'** o de forma m√°s informal **'Salut, √ßa va ?'**."
            },
            {
                question: "que es el cambio climatico",
                answer: "El **cambio clim√°tico** se refiere a los cambios a largo plazo en las temperaturas y los patrones clim√°ticos de la Tierra. Aunque ha habido cambios naturales en el pasado, desde el siglo XIX, las actividades humanas (principalmente la quema de combustibles f√≥siles como carb√≥n, petr√≥leo y gas) han sido el principal impulsor, aumentando los gases de efecto invernadero en la atm√≥sfera."
            },
            {
                question: "como puedo aprender a programar",
                answer: "¬°Aprender a programar es accesible! Aqu√≠ tienes pasos comunes: \n1.  **Elige un lenguaje para empezar:** Python es muy recomendado para principiantes por su sintaxis clara. JavaScript es esencial para desarrollo web. \n2.  **Usa recursos en l√≠nea:** Plataformas como Codecademy, freeCodeCamp, Khan Academy, Coursera, edX ofrecen cursos gratuitos y de pago. \n3.  **Practica constantemente:** La programaci√≥n se aprende haciendo. Resuelve peque√±os problemas, crea proyectos simples. \n4.  **Lee c√≥digo de otros:** Ayuda a entender diferentes enfoques. \n5.  **√önete a comunidades:** Foros como Stack Overflow o grupos de Discord pueden ser muy √∫tiles."
            },
            {
                question: "que es el big bang",
                answer: "El **Big Bang** es la teor√≠a cosmol√≥gica predominante sobre el origen del universo. Sugiere que el universo comenz√≥ como un punto extremadamente caliente y denso hace unos 13.8 mil millones de a√±os, y desde entonces se ha estado expandiendo y enfriando, formando galaxias, estrellas y planetas."
            },
            {
                question: "cuales son los beneficios de hacer ejercicio regularmente",
                question_alt: "para que sirve hacer ejercicio",
                answer: "Hacer ejercicio regularmente tiene much√≠simos beneficios: \n*   **Salud cardiovascular:** Fortalece el coraz√≥n y mejora la circulaci√≥n. \n*   **Control de peso:** Ayuda a quemar calor√≠as y mantener un peso saludable. \n*   **Fortalecimiento muscular y √≥seo:** Reduce el riesgo de osteoporosis y mejora la fuerza. \n*   **Salud mental:** Reduce el estr√©s, la ansiedad y la depresi√≥n, y mejora el estado de √°nimo y el sue√±o. \n*   **Aumento de energ√≠a:** Aunque parezca contradictorio, te da m√°s vitalidad."
            },
            {
                question: "que es la economia circular",
                answer: "La **econom√≠a circular** es un modelo de producci√≥n y consumo que busca extender el ciclo de vida de los productos. Se centra en compartir, alquilar, reutilizar, reparar, renovar y reciclar materiales y productos existentes durante el mayor tiempo posible. El objetivo es reducir los residuos al m√≠nimo y aprovechar al m√°ximo los recursos, en contraste con el modelo lineal tradicional de 'tomar, hacer, desechar'."
            },
            {
                question: "como puedo mejorar mi ingles",
                answer: "Mejorar tu ingl√©s requiere pr√°ctica constante. Aqu√≠ tienes algunas estrategias: \n*   **Inmersi√≥n:** Escucha m√∫sica, podcasts, mira pel√≠culas y series en ingl√©s (con o sin subt√≠tulos seg√∫n tu nivel). \n*   **Pr√°ctica oral:** Intenta hablar, aunque sea solo contigo mismo o con otros estudiantes/hablantes nativos (apps como Tandem o HelloTalk pueden ayudar). \n*   **Lectura:** Lee art√≠culos, noticias, libros en ingl√©s adecuados a tu nivel. \n*   **Vocabulario:** Usa apps como Duolingo, Memrise o Anki para aprender palabras nuevas. \n*   **Gram√°tica:** Consulta recursos en l√≠nea o libros para entender las reglas. \n*   **¬°No tengas miedo a equivocarte!** Es parte del aprendizaje."
            },
            {
                question: "que es el blockchain",
                question_alt: "que es blockchain",
                answer: "**Blockchain** (cadena de bloques) es una tecnolog√≠a de registro digital distribuido, descentralizado e inmutable. Imagina un libro de contabilidad digital que se comparte entre muchas computadoras. Cada 'bloque' contiene un conjunto de transacciones, y cada nuevo bloque se enlaza criptogr√°ficamente al anterior, formando una 'cadena'. Esto hace que sea muy dif√≠cil alterar la informaci√≥n una vez registrada. Es la tecnolog√≠a detr√°s de muchas criptomonedas como Bitcoin."
            },
            {
                question: "como se prepara un buen cafe",
                answer: "Preparar un 'buen' caf√© depende mucho del gusto personal, ¬°pero aqu√≠ hay claves generales! \n1.  **Caf√© de calidad y fresco:** Usa granos reci√©n tostados si es posible y mu√©lelos justo antes de prepararlo. \n2.  **Molienda adecuada:** Ajusta el grosor de la molienda al m√©todo que uses (gruesa para prensa francesa, media para goteo, fina para espresso). \n3.  **Agua de calidad:** Usa agua filtrada si es posible, calentada a la temperatura correcta (generalmente entre 90¬∞C y 96¬∞C, no hirviendo). \n4.  **Proporci√≥n correcta:** Una gu√≠a com√∫n es usar entre 10 y 15 gramos de caf√© por cada 180 ml de agua. ¬°Experimenta! \n5.  **M√©todo de preparaci√≥n:** Elige el que prefieras (prensa francesa, V60, Aeropress, cafetera italiana, espresso...) y sigue sus pasos."
            },
            {
                question: "que es el machine learning",
                question_alt: "que es machine learning",
                answer: "El **Machine Learning** (Aprendizaje Autom√°tico) es una rama de la Inteligencia Artificial. Se enfoca en desarrollar algoritmos que permiten a las computadoras 'aprender' de los datos sin ser programadas expl√≠citamente para cada tarea. Analizan grandes cantidades de datos, identifican patrones y toman decisiones o hacen predicciones basadas en ese aprendizaje. Ejemplos incluyen sistemas de recomendaci√≥n (Netflix, Spotify) y reconocimiento de im√°genes."
            },
            {
                question: "cuales son los sintomas del covid-19",
                question_alt: "sintomas covid",
                answer: "Los s√≠ntomas del COVID-19 pueden variar mucho, pero los m√°s comunes incluyen: \n*   Fiebre o escalofr√≠os \n*   Tos \n*   Falta de aire o dificultad para respirar \n*   Fatiga \n*   Dolores musculares o corporales \n*   Dolor de cabeza \n*   P√©rdida reciente del olfato o del gusto \n*   Dolor de garganta \n*   Congesti√≥n o secreci√≥n nasal \n*   N√°useas, v√≥mitos o diarrea. \n**Importante:** Si tienes s√≠ntomas graves, busca atenci√≥n m√©dica."
            },
            {
                question: "como puedo ahorrar dinero",
                answer: "Ahorrar dinero es un h√°bito importante. Aqu√≠ tienes algunas estrategias: \n1.  **Haz un presupuesto:** Registra tus ingresos y gastos para saber a d√≥nde va tu dinero. \n2.  **Establece metas de ahorro:** ¬øPara qu√© quieres ahorrar? (Emergencias, viaje, entrada de piso...). \n3.  **P√°gate a ti primero:** Automatiza una transferencia a tu cuenta de ahorros cada vez que cobres. \n4.  **Reduce gastos innecesarios:** Identifica d√≥nde puedes recortar (suscripciones que no usas, comidas fuera frecuentes...). \n5.  **Compara precios:** Antes de hacer compras grandes, busca ofertas y compara. \n6.  **Cocina m√°s en casa:** Suele ser m√°s econ√≥mico que comer fuera."
            },
            {
                question: "que es la sostenibilidad",
                answer: "La **sostenibilidad** consiste en satisfacer las necesidades del presente sin comprometer la capacidad de las generaciones futuras para satisfacer las suyas. Se basa en tres pilares interconectados: \n1.  **Ambiental:** Proteger los ecosistemas, conservar recursos naturales, reducir la contaminaci√≥n. \n2.  **Social:** Asegurar la equidad, la salud, la educaci√≥n y el bienestar de las personas. \n3.  **Econ√≥mico:** Promover un crecimiento econ√≥mico que sea viable a largo plazo y justo para la sociedad."
            },

            // --- Preguntas adicionales a√±adidas por la IA ---
            {
                question: "hola", // Para saludo inicial
                answer: "¬°Hola! Soy Leanny IA. üòä ¬øEn qu√© te puedo ayudar hoy?"
            },
            {
                 question: "c√≥mo est√°s", // Sin tilde intencionalmente
                 question_alt: "como estas", // Alternativa com√∫n
                 answer: "Como programa, ¬°siempre estoy funcionando perfectamente! Listo para charlar."
            },
            {
                question: "puedes contar un chiste",
                question_alt: "cuentame un chiste",
                answer: "¬°Claro! Aqu√≠ va uno: ¬øQu√© le dice un jaguar a otro jaguar? ¬°'Jaguar you?' üòÑ"
            },
            {
                question: "que dia es hoy",
                answer: "No tengo acceso a un calendario en tiempo real, ¬°pero espero que est√©s teniendo un d√≠a fant√°stico!"
            },
            {
                question: "que significa chatbot",
                answer: "Un 'chatbot' es un programa inform√°tico dise√±ado para simular conversaciones con usuarios humanos, especialmente a trav√©s de interfaces de texto o voz. ¬°Como yo!"
            },
            {
                question: "como funciona internet",
                answer: "Uf, ¬°es complejo! Pero de forma muy simple: Internet es una red gigante que conecta millones de computadoras en todo el mundo. Usan lenguajes comunes (protocolos como TCP/IP) para enviarse paquetes de datos. Cuando visitas una web, tu navegador pide esos datos a un servidor, y viajan por cables submarinos, sat√©lites y redes locales hasta llegar a tu pantalla."
            },
            {
                question: "gracias", // Para cortes√≠a
                answer: "¬°De nada! Si necesitas algo m√°s, no dudes en preguntar. üòâ"
            },
            {
                question: "adios",
                question_alt: "chao", // Alternativa
                answer: "¬°Hasta la pr√≥xima! Ha sido un placer charlar contigo. üëã"
            }
        ];

        // --- Funci√≥n para encontrar la respuesta (igual que antes) ---
        function findAnswer(userInput) {
            const processedInput = userInput.toLowerCase().trim()
                                          .replace(/[¬ø?¬°!,.:;]/g, ''); // Quita m√°s puntuaci√≥n

            // Buscar coincidencia exacta primero
             for (const qa of predefinedQA) {
                 const questionProcessed = qa.question.toLowerCase().trim().replace(/[¬ø?¬°!,.:;]/g, '');
                 const altQuestionProcessed = qa.question_alt ? qa.question_alt.toLowerCase().trim().replace(/[¬ø?¬°!,.:;]/g, '') : null;

                if (processedInput === questionProcessed || (altQuestionProcessed && processedInput === altQuestionProcessed)) {
                    console.log(`Match found for: "${userInput}" -> "${qa.question}"`);
                    return qa.answer;
                }
            }

            // Si no hay coincidencia exacta, buscar si la entrada CONTIENE alguna palabra clave (simple)
            // Esto es muy b√°sico, podr√≠a mejorarse mucho
             const wordsInInput = processedInput.split(/\s+/); // Divide en palabras
             let bestMatch = null;
             let maxMatchCount = 0;

             for (const qa of predefinedQA) {
                 const questionWords = qa.question.toLowerCase().trim().replace(/[¬ø?¬°!,.:;]/g, '').split(/\s+/);
                 let currentMatchCount = 0;
                 for(const word of wordsInInput) {
                     if (word.length > 2 && questionWords.includes(word)) { // Ignora palabras cortas
                         currentMatchCount++;
                     }
                 }
                 if (currentMatchCount > maxMatchCount) {
                     maxMatchCount = currentMatchCount;
                     bestMatch = qa.answer;
                 }
             }

             if (bestMatch && maxMatchCount > 1) { // Requiere al menos 2 palabras clave coincidentes
                  console.log(`Partial match found for: "${userInput}"`);
                 return bestMatch;
             }


            // Respuesta por defecto si no se encuentra nada
             console.log(`No match found for: "${userInput}"`);
            return "Lo siento, no estoy segura de entender eso. ¬øPodr√≠as reformular tu pregunta? Puedes escribir 'ayuda' para ver ejemplos de lo que s√©.";
        }

        // --- Funci√≥n Principal Modificada (igual que antes) ---
        function handleUserSubmit() {
            const userQuestion = promptInput.value.trim();
            if (!userQuestion) {
                showUserMessage('Por favor, escribe una pregunta.', 'warning');
                return;
            }

            setLoadingState(true);
            responseBox.innerHTML = '<p>Pensando...</p>'; // Mensaje mientras "piensa"
            copyButton.disabled = true;
            saveButton.disabled = true;

            setTimeout(() => {
                const botAnswer = findAnswer(userQuestion);
                displayFormattedResult(botAnswer);
                copyButton.disabled = false;
                saveButton.disabled = false;
                setLoadingState(false);
            }, 400 + Math.random() * 400); // Retraso ligeramente m√°s corto
        }

        // --- Funciones Auxiliares (igual que antes) ---
         function displayFormattedResult(text) {
             responseBox.innerHTML = marked.parse(text);
             Prism.highlightAllUnder(responseBox);
        }

        function handleClear() {
            promptInput.value = '';
            responseBox.innerHTML = '<p>¬°Hola! Soy Leanny IA. ¬øListo para preguntar?</p>'; // Restaura mensaje inicial
            copyButton.disabled = true;
            saveButton.disabled = true;
        }

        async function handleCopyToClipboard() {
            const text = responseBox.innerText;
             if (!text || responseBox.textContent.includes('¬øListo para preguntar?') || responseBox.textContent.includes('Pensando...')) {
                 showUserMessage('No hay contenido v√°lido para copiar.', 'info');
                 return;
             }
            try {
                await navigator.clipboard.writeText(text);
                const originalContent = copyButton.innerHTML;
                copyButton.innerHTML = `<span>¬°Copiado!</span>`;
                copyButton.disabled = true;
                setTimeout(() => {
                    copyButton.innerHTML = originalContent;
                    copyButton.disabled = false;
                }, 1500);
            } catch (err) {
                console.error('Fallo al copiar:', err);
                showUserMessage('Error al copiar al portapapeles.', 'error');
            }
        }

        function handleSaveToFile() {
             const text = responseBox.innerText;
              if (!text || responseBox.textContent.includes('¬øListo para preguntar?') || responseBox.textContent.includes('Pensando...')) {
                 showUserMessage('No hay contenido v√°lido para guardar.', 'info');
                 return;
             }
            try {
                const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `leanny-ia-respuesta-${Date.now()}.txt`; // Nombre de archivo actualizado
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error("Error al guardar:", error);
                showUserMessage('No se pudo guardar el archivo.', 'error');
            }
        }

        function setLoadingState(isLoading) {
            loader.style.display = isLoading ? 'flex' : 'none';
            submitButton.disabled = isLoading;
            clearButton.disabled = isLoading;
        }

        function showUserMessage(message, type = 'info') {
            alert(`[${type.toUpperCase()}] ${message}`);
        }

        // --- Event Listeners ---
        submitButton.addEventListener('click', handleUserSubmit);
        clearButton.addEventListener('click', handleClear);
        copyButton.addEventListener('click', handleCopyToClipboard);
        saveButton.addEventListener('click', handleSaveToFile);
        promptInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !(e.ctrlKey || e.metaKey || e.shiftKey)) { // Enviar con Enter (sin modificadores)
                e.preventDefault(); // Evita salto de l√≠nea
                handleUserSubmit();
            }
        });

        console.log("Leanny IA listo para conversar.");

    </script>
</body>
</html>